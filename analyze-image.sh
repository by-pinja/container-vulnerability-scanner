#!/bin/sh
DOCKER_USERNAME=$1
DOCKER_PASSWORD=$2
TARGET_IMAGE=$3

# This is workaround, local scan with clairctl is broken if there is semicolon in name...
DUMMY_NAME_FOR_IMAGE=$4

echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin

docker pull $TARGET_IMAGE
docker tag $TARGET_IMAGE $DUMMY_NAME_FOR_IMAGE

clairctl analyze --local $DUMMY_NAME_FOR_IMAGE