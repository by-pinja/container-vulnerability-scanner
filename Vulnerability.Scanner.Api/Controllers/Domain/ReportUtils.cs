using System.Collections.Generic;
using System.Linq;
using Vulnerability.Scanner.Api.Data;

namespace Vulnerability.Scanner.Api.Controllers.Domain
{
    public static class ReportUtils
    {
        public static IEnumerable<VulnerabilityModel> GetSortedVurnerabilitiesBySeverity(IEnumerable<VulnerabilityModel> original)
        {
            return original.OrderByDescending(x => ConvertSeverityToWeightedSortableNumber(x.Severity));
        }

        private static int ConvertSeverityToWeightedSortableNumber(string severity)
        {
            switch(severity.ToLower())
            {
                case "defcon":
                    return 1000;
                case "critical":
                    return 100;
                case "high":
                    return 50;
                case "medium":
                    return 3;
                case "low":
                    return 2;
                default:
                    return 1;
            }
        }

        public static int GetWeightedVurnerabilityCount(IEnumerable<VulnerabilityModel> original)
        {
            return original.Sum(x => ConvertSeverityToWeightedSortableNumber(x.Severity));
        }
    }
}