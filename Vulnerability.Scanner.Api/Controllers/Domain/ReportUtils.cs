using System.Collections.Generic;
using System.Linq;
using Vulnerability.Scanner.Api.Data;

namespace Vulnerability.Scanner.Api.Controllers.Domain
{
    public static class ReportUtils
    {
        public static IEnumerable<VulnerabilityModel> GetSortedVurnerabilitiesBySeverity(IEnumerable<VulnerabilityModel> original)
        {
            return original.OrderBy(x => ConvertSeverityToSortableNumber(x.Severity));
        }

        private static int ConvertSeverityToSortableNumber(string severity)
        {
            switch(severity.ToLower())
            {
                case "defcon":
                    return 1;
                case "critical":
                    return 10;
                case "high":
                    return 100;
                case "medium":
                    return 200;
                case "low":
                    return 300;
                default:
                    return 9999;
            }
        }
    }
}