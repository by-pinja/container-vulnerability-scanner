@model IEnumerable<Vulnerability.Scanner.Api.Model.GroupSummaryModel>
@using Vulnerability.Scanner.Api.Controllers.Domain

<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Report summary</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
        crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">

    <style>
        .removeButtonContainer {
            padding-left: 0 !important;
            text-align: center;
        }

        .removeButton {
            color: #007bff;
            padding: 0;
            border: none;
            background: none;
            cursor: pointer;
        }
        .removeButton:focus {
            outline:0;
        }
    </style>

</head>

<script type="text/javascript">
    function deleteGroup(groupId) {
        if (confirm("Do you want to delete " + groupId + "?")) {
            var url = '@Url.Content("~/v1/group/")' + groupId;
            var xhr = new XMLHttpRequest();
            xhr.open("DELETE", url, true);
            xhr.onload = function () {
                if (xhr.readyState == 4 && xhr.status == "200") {
                    console.log(`Removed group ${groupId}`);
                    // Ugly as hell but simple...
                    location.reload();
                }
            }
            xhr.send(null);
        }
    }
</script>

<body>
    <div class="container">
        <h1>Report summary</h1>

        <table class="table">
            <thead class="thead-light">
                <th scope="col">GroupId</th>
                <th scope="col">Defcon</th>
                <th scope="col">Critical</th>
                <th scope="col">High</th>
                <th scope="col"></th>
            </thead>
            <tbody>
                @foreach(var summary in Model) {
                    <tr>
                        <td><a href="/v1/group/@summary.GroupId/html">@summary.GroupId</a> </td>
                        <td>@summary.Defcon </td>
                        <td>@summary.Critical </td>
                        <td>@summary.High </td>
                        <td class="removeButtonContainer">
                            <button class="removeButton" onclick="deleteGroup('@summary.GroupId')"><i class="fas fa-trash-alt"></i></button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</body>

</html>