using System;
using Microsoft.Extensions.Options;
using Vulnerability.Scanner.Api.Data;

namespace Vulnerability.Scanner.Api.Controllers.Models
{
    public class VulnerabilityScanResponse: VulnerabilityScanRequest
    {
        public VulnerabilityScanResponse() {}

        public VulnerabilityScanResponse(ReportModel reportModel, IOptions<GeneralOptions> config)
        {
            ScanId = reportModel.Id;
            Image = reportModel.Image;
            Meta = reportModel.MetaData;
            HtmlResultsUri = $"{config.Value.AppRootUri}/v1/reports/{reportModel.Id}/html";
            ResultsUri = $"{config.Value.AppRootUri}/v1/reports/{reportModel.Id}";
        }

        public Guid ScanId { get; set; }
        public string HtmlResultsUri { get; set; }
        public string ResultsUri { get; set; }
    }
}