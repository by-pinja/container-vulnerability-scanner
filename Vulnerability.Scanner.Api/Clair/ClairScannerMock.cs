using System;
using System.Collections.Generic;
using System.Linq;
using Hangfire;
using Microsoft.Extensions.Options;
using Vulnerability.Scanner.Api.Data;
using Vulnerability.Scanner.Api.Options;

namespace Vulnerability.Scanner.Clair
{
    public class ClairScannerMock : IClairScanner
    {
        private readonly IBackgroundJobClient _jobClient;
        private readonly ScannerDataContext _dataContext;

        public ClairScannerMock(IBackgroundJobClient jobClient, ScannerDataContext dataContext)
        {
            _jobClient = jobClient;
            _dataContext = dataContext;
        }

        public void CreateReport(Guid reportId)
        {
            var report = _dataContext.Reports.Single(x => x.Id == reportId);
            report.Processed = true;

            report.Vurnelabilities = new List<VurnelabilityModel>()
            {
            //    new VurnelabilityModel("reportName", "namespace", "description", "link", "severity")
            };

            _dataContext.SaveChanges();
        }
    }
}