using System;
using Newtonsoft.Json;
using Vulnerability.Scanner.Api.Depencies;

namespace Vulnerability.Scanner.Api.Data
{
    public class VurnelabilityModel
    {
        [JsonConstructor]
        public VurnelabilityModel() { }

        public VurnelabilityModel(string name, string @namespace, string description, string link, string severity)
        {
            Name = name;
            Namespace = @namespace;
            Description = description;
            Link = link;

            switch (severity.ToLower())
            {
                case "high":
                    Severity = Severity.High;
                    break;
                case "medium":
                    Severity = Severity.Medium;
                    break;
                case "low":
                    Severity = Severity.Low;
                    break;
                case "negligible":
                    Severity = Severity.Negligible;
                    break;
                case "unknown":
                    Severity = Severity.Unknown;
                    break;
                default:
                    throw new InvalidOperationException($"Cannot convert '{severity}' to {nameof(Severity)}");
            }
        }

        public Guid Id { get; protected set; }
        public string Name { get; set; }
        public string Namespace { get; }
        public string Description { get; set; }
        public string Link { get; set; }
        public Severity Severity { get; set; }
        public string Feature { get; set; }
        public string FeatureVersion { get; set; }
    }
}